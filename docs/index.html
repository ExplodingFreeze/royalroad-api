<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@fsoc/royalroadl-api</title><meta name="description" content="Documentation for @fsoc/royalroadl-api"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@fsoc/royalroadl-api</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@fsoc/royalroadl-api</h1></div><div class="tsd-panel tsd-typography"><p>An unofficial API for <a href="https://royalroadl.com" target="_blank" class="external">royalroadl.com</a>, written in TypeScript.</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1"> -</span><span class="hl-0">s</span><span class="hl-1"> @</span><span class="hl-0">fsoc</span><span class="hl-1">/</span><span class="hl-0">royalroadl</span><span class="hl-1">-</span><span class="hl-0">api</span>
</code><button>Copy</button></pre>

<p>This is an attempt to write a predictable and consistent wrapper around the mess that is RRL. Since no official public API is exposed, this module scrapes all data straight from the HTML, which makes it very prone to spontaneous and horrible death.</p>
<p>Barebones documentation generated from <a href="http://typedoc.org/" target="_blank" class="external">TypeDoc</a> can be found on <a href="https://fsoc.gitlab.io/royalroadl-api/classes/royalroadapi.html" target="_blank" class="external">fsoc.gitlab.com/royalroadl-api</a>. You can also build these docs yourself by running <code>npm run docs</code> in the root of the project.</p>
<p>A more elaborate description of this package and its functionality (both internal and exposed) can be found further below in the <a href="#md:about">about</a> section.</p>
<a id="md:example-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Example usage<a href="#md:example-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>For more examples check out the <code>/examples</code> directory.</p>
<pre><code class="javascript"><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-3">RoyalRoadAPI</span><span class="hl-1"> } = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-5">&#39;@fsoc/royalroadl-api&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">api</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-4">RoyalRoadAPI</span><span class="hl-1">();</span><br/><br/><span class="hl-1">(</span><span class="hl-2">async</span><span class="hl-1"> () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-3">data</span><span class="hl-1"> } = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-0">api</span><span class="hl-1">.</span><span class="hl-0">fictions</span><span class="hl-1">.</span><span class="hl-4">getPopular</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">titles</span><span class="hl-1"> = </span><span class="hl-0">data</span><span class="hl-1">.</span><span class="hl-4">slice</span><span class="hl-1">(</span><span class="hl-7">10</span><span class="hl-1">).</span><span class="hl-4">map</span><span class="hl-1">((</span><span class="hl-0">fic</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-0">fic</span><span class="hl-1">.</span><span class="hl-0">title</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-5">`The top 10 popular fictions are: </span><span class="hl-2">${</span><span class="hl-0">titles</span><span class="hl-8">.</span><span class="hl-4">join</span><span class="hl-8">(</span><span class="hl-5">&#39;, &#39;</span><span class="hl-8">)</span><span class="hl-2">}</span><span class="hl-5">`</span><span class="hl-1">);</span><br/><span class="hl-1">})().</span><span class="hl-4">catch</span><span class="hl-1">(</span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:about" class="tsd-anchor"></a><h2 class="tsd-anchor-link">About<a href="#md:about" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The module itself exports only a <code>RoyalRoadAPI</code> class which, by itself, has no methods. All functionality is delegated to service classes which are properties of the <code>RoyalRoadAPI</code> instance. This allows for a very concise seperation of concerns, and a modular and atomic approach to both the development, and usage of this module.</p>
<a id="md:responses" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Responses<a href="#md:responses" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All responses and errors are either an instance of a <a href="https://fsoc.gitlab.io/royalroadl-api/classes/royalresponse.html" target="_blank" class="external"><code>RoyalResponse</code></a> or a <a href="https://fsoc.gitlab.io/royalroadl-api/classes/royalerror.html" target="_blank" class="external"><code>RoyalError</code></a>, which extends <code>RoyalResponse</code>. This is done to easily allow for meta information to be tacked onto responses, and to have a consistent interface between user and module. Note that the <code>RoyalError</code> acts similarly to the NodeJS <code>Error</code> object, in that it captures and returns a short stack trace.</p>
<p>For example, a call to <code>fiction.getFiction()</code> might yield the following response on success:</p>
<pre><code class="javascript"><span class="hl-0">RoyalResponse</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-9">data</span><span class="hl-1">:</span><br/><span class="hl-1">   { </span><span class="hl-9">type</span><span class="hl-1">: </span><span class="hl-5">&#39;Original&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-9">tags</span><span class="hl-1">: [ </span><span class="hl-5">&#39;Action&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;Adventure&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;Sci-fi&#39;</span><span class="hl-1">, ... </span><span class="hl-7">3</span><span class="hl-1"> </span><span class="hl-0">more</span><span class="hl-1"> </span><span class="hl-0">items</span><span class="hl-1"> ],</span><br/><span class="hl-1">     </span><span class="hl-9">stats</span><span class="hl-1">:</span><br/><span class="hl-1">      { </span><span class="hl-9">pages</span><span class="hl-1">: </span><span class="hl-7">766</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">ratings</span><span class="hl-1">: </span><span class="hl-7">719</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">followers</span><span class="hl-1">: </span><span class="hl-7">2991</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">favorites</span><span class="hl-1">: </span><span class="hl-7">690</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">views</span><span class="hl-1">: [</span><span class="hl-0">Object</span><span class="hl-1">],</span><br/><span class="hl-1">        </span><span class="hl-9">score</span><span class="hl-1">: [</span><span class="hl-0">Object</span><span class="hl-1">] },</span><br/><span class="hl-1">     </span><span class="hl-9">title</span><span class="hl-1">: </span><span class="hl-5">&#39;Paladin&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-9">image</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-5">&#39;https://www.royalroadcdn.com/(...)&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-9">status</span><span class="hl-1">: </span><span class="hl-5">&#39;HIATUS&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-9">author</span><span class="hl-1">:</span><br/><span class="hl-1">      { </span><span class="hl-9">name</span><span class="hl-1">: </span><span class="hl-5">&#39;Komikhan&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">title</span><span class="hl-1">: </span><span class="hl-5">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">avatar</span><span class="hl-1">:</span><br/><span class="hl-1">         </span><span class="hl-5">&#39;https://www.royalroadcdn.com/(...)&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-9">id</span><span class="hl-1">: </span><span class="hl-7">66486</span><span class="hl-1"> },</span><br/><span class="hl-1">     </span><span class="hl-9">warnings</span><span class="hl-1">: [ </span><span class="hl-5">&#39;Gore&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;Profanity&#39;</span><span class="hl-1"> ],</span><br/><span class="hl-1">     </span><span class="hl-9">chapters</span><span class="hl-1">: [ [</span><span class="hl-0">Object</span><span class="hl-1">], [</span><span class="hl-0">Object</span><span class="hl-1">], [</span><span class="hl-0">Object</span><span class="hl-1">], ... </span><span class="hl-7">71</span><span class="hl-1"> </span><span class="hl-0">more</span><span class="hl-1"> </span><span class="hl-0">items</span><span class="hl-1"> ],</span><br/><span class="hl-1">     </span><span class="hl-9">description</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-5">&#39;When the first derelict alien spacecraft fell to Earth, (...)&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-9">success</span><span class="hl-1">: </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-9">timestamp</span><span class="hl-1">: </span><span class="hl-7">1528119296799</span><span class="hl-1"> }</span>
</code><button type="button">Copy</button></pre>

<p>...or on error:</p>
<pre><code class="javascript"><span class="hl-0">RoyalError</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-9">data</span><span class="hl-1">:</span><br/><span class="hl-1">   { </span><span class="hl-9">message</span><span class="hl-1">: </span><span class="hl-5">&#39;Page Not Found&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-9">stack</span><span class="hl-1">:</span><br/><span class="hl-1">      [ </span><span class="hl-5">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">&#39;    at new RoyalError&#39;</span><span class="hl-1">, ... </span><span class="hl-7">8</span><span class="hl-1"> </span><span class="hl-0">more</span><span class="hl-1"> </span><span class="hl-0">items</span><span class="hl-1"> ] },</span><br/><span class="hl-1">  </span><span class="hl-9">success</span><span class="hl-1">: </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-9">timestamp</span><span class="hl-1">: </span><span class="hl-7">1528119381034</span><span class="hl-1"> }</span>
</code><button type="button">Copy</button></pre>

<a id="md:internal-requester" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Internal requester<a href="#md:internal-requester" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All service classes use the same instance of the <code>Requester</code>, the class responsible for making HTTP requests and returning their responses. By default, it will throw a <code>RoyalError</code> if it encounters a status code other than 200 (this can be disabled with the <code>ignoreStatus</code> option). Also note that, by default, all requests will be sent over HTTPS - this can be controlled with the first argument of the <code>RoyalRoadAPI</code> constructor.</p>
<p>Since RRL likes to return 200 even when the actual response should be a 404 or 304, the <code>Requester</code> will parse the HTML it has gotten (if it got any), and try to read an error from it. If it finds signs that the request has failed, it will throw - this can be disabled with the <code>ignoreParser</code> option.</p>
<p>The <code>Requester</code>s main goal is to keep track of cookies and to automatically fetch a <code>__ResponseVerificationToken</code> often needed for POST requests as a part of anti CSRF measures. This fetching of tokens is disabled by default and can be enabled with the <code>fetchToken</code> option.</p>
<a id="md:structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Structure<a href="#md:structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All services are structured in a very similar way: with a <code>&lt;Type&gt;Service</code> exposing all relevant methods, and a <code>&lt;Type&gt;Parser</code>, which usually exposes a number of static methods used to parse HTML responses.</p>
<p>A quick wrap-up of all the existing services is:</p>
<ul>
<li><code>ChapterService</code>, contains methods for fetching and publishing chapters and chapter comments.</li>
<li><code>FictionService</code>, fetching fiction data and reviews.</li>
<li><code>FictionsService</code>, methods for fetching all types of fiction lists RRL offers, with their respective levels of per fiction detail.</li>
<li><code>ProfileService</code>, handling profiles, returns parsed user profiles.</li>
<li><code>UserService</code>, actions related to the logged-in user like logon, getting the users' fictions, bookmarks, or notifications.</li>
</ul>
<a id="md:parsing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Parsing<a href="#md:parsing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This uses <a href="https://github.com/cheeriojs/cheerio" target="_blank" class="external">cheerio</a> to parse HTML, which is a very forgiving parser. This means that even if RRL were to make minor changes to their page layouts, large parts of the API (even those parts responsible for changed areas) would still remain functional.</p>
<p>Therefore, expect properties to be empty or <code>null</code>, and know that an error will not be thrown just because some values could not be parsed.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:example-usage"><span>Example usage</span></a><a href="#md:about"><span>About</span></a><ul><li><a href="#md:responses"><span>Responses</span></a></li><li><a href="#md:internal-requester"><span>Internal requester</span></a></li><li><a href="#md:structure"><span>Structure</span></a></li><li><a href="#md:parsing"><span>Parsing</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@fsoc/royalroadl-api</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
